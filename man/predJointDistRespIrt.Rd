% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predJointDistRespIrt.R
\name{predJointDistRespIrt}
\alias{predJointDistRespIrt}
\title{Probabilistic predictions of joint item responses from an IRT model}
\usage{
predJointDistRespIrt(
  model,
  dataSub,
  nSimTheta = 500,
  nSimItem = 2,
  seed = 131820,
  givenVal = NULL,
  priorGrid = NULL
)
}
\arguments{
\item{model}{An IRT model fitted with \code{\link{fitIrt}}. This object
contains the fitted \code{mirt} model and meta-data (item names, response
labels, latent regression formula).}

\item{dataSub}{One-row data frame with the predictor variables for the
current person used in the latent regression (if specified in \code{model}).}

\item{nSimTheta}{Integer; number of simulated draws of the latent variables.}

\item{nSimItem}{Integer; number of simulated response patterns per latent
draw (for each sampled latent variable, \code{nSimItem} independent
response patterns are generated).}

\item{seed}{Integer seed for reproducibility of all simulations.}

\item{givenVal}{Optional named numeric vector of already observed item
responses for a subset of items (e.g., \code{c(PHQ1 = 2, PHQ3 = 1)}). Names
must match item names in \code{model$respName}. If \code{NULL}, no
responses are conditioned on and predictions are based on the prior
distribution of the latent variables.}

\item{priorGrid}{Optional list representing an approximated distribution of
the latent variables from a previous step (typically the
\code{postDistTheta} element from an earlier call to
\code{predJointDistRespIrt}). If \code{NULL}, the prior multivariate
distribution of the latent variables implied by the IRT model (and latent
regression, if specified) is used.}
}
\value{
A list with components:
\describe{
  \item{\code{postDistTheta}}{If \code{givenVal} is not \code{NULL}, a list
    with components \code{dist} (matrix with grid points of the latent
    variables and their posterior probabilities) and \code{givenVal} (all
    item responses that have been conditioned on so far).}
  \item{\code{sim}}{Data frame containing all simulated response patterns
    generated from the IRT model given the simulated latent variables.}
  \item{\code{jointDist}}{Data frame containing the approximated joint
    distribution of item responses. Each row corresponds to a distinct
    response pattern; the last column \code{freq} contains its relative
    frequency (probability).}
}
}
\description{
\code{predJointDistRespIrt()} performs probabilistic predictions of item
responses based on an IRT model fitted with \code{\link{fitIrt}}. The method
can incorporate predictors (via a latent regression, if specified) and
optionally already observed responses for a subset of items.

The predictions are obtained in four steps (see Wyss et al. (2025) for
further details):
\enumerate{
  \item Predict the distribution of the latent variables (possibly
  conditional on predictors via the latent regression).
  \item Draw samples of latent variables from this distribution.
  \item For each sampled latent variable, simulate item response patterns
  from the IRT model, assuming conditional independence of items given the
  latent variables.
  \item Approximate the (conditional) joint distribution of item responses
  based on the simulated response patterns.
}
}
\references{
Wyss, P., Steiner, D., Lopes, R., M., Sipka, Berger, T., & Krause, A. (2025).
Decision-Oriented Adaptive Testing for Efficient Screening Across Mental Disorders.
Manuscript in preparation.
}
